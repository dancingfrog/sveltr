---
title: "Compare Current To Past Stats"
author: "John Hall"
date: "3/25/2020"
output: html_document
---

```{r setup, echo=FALSE, include=FALSE}
options(warn = -1)
working_dir <- getwd()
# print(working_dir)
# print(grepl("/content", getwd(), ignore.case = TRUE))
if (grepl("/content", getwd(), ignore.case = TRUE)) {
    working_dir <- stringr::str_replace(getwd(), "/content", "")
    setwd(working_dir)
}

require("jsonlite")
require("stringr")

# Input params
country <- c("CAN")
current_version <- c("202012")
previous_version <- c("202009")

download_links <- c()

downloadPath <- c("CURRENT")
```

## Compare Statistics

Now that we have statistics for past releases (201809 - 201909) that are comparable to the current build (202006), we need to create tables which calculate comparisons (deltas) between the parallel sets, per-Country (identified by 3-letter code).
```{r read_stats, echo=FALSE}
setwd(working_dir)

# Get from country-codes model
country_code3 <- list(code3 = c("can"))
country_code4 <- list(code4 = NULL)
state_codes <- list(state_codes = c()) #list(state_codes = c("AB", "BC", "MB", "NB", "NL", "NS", "NT", "NU", "ON", "PE", "QC", "SK", "YT"))
state_flag <- c(FALSE)

source(paste0(working_dir, "/src/compare-stats.R"))

```

Now populate the sheets (Counts, Street Lengths and Layer Specific Counts):
```{r compare_stats, echo=FALSE}

# Create data.frame for counts comparison
counts_frame <- data.frame(c(NA), c(NA), c(NA), c(NA), c(NA))
names(counts_frame) <- c(
    "Layer Type",
    "Layer",
    paste0("Object Count - ", current_version),
    paste0("Object Count - ", previous_version),
    "Delta"
)
# Delete all rows
counts_frame <- counts_frame[-1,1:length(counts_frame)]
head(counts_frame)


# Create data.frame for speed profiles sets comparison
speed_profiles_frame <- data.frame(c(NA), c(NA), c(NA), c(NA), c(NA))
names(speed_profiles_frame) <- c(
    "Layer Type",
    "Layer",
    paste0("Object Count - ", current_version),
    paste0("Object Count - ", previous_version),
    "Delta"
)
# Delete all rows
speed_profiles_frame <- speed_profiles_frame[-1,1:length(speed_profiles_frame)]
head(speed_profiles_frame)

# Create data.frame for street_lengths comparison
street_lengths_frame <- data.frame(c(NA), c(NA), c(NA), c(NA), c(NA))
names(street_lengths_frame) <- c(
    "Streets Type",
    "Layer Name (Road Class)",
    paste0("Length (", length_units, ") - ", current_version),
    paste0("Length (", length_units, ") - ", previous_version),
    "Delta"
)
# Delete all rows
street_lengths_frame <- street_lengths_frame[-1,1:length(street_lengths_frame)]
head(street_lengths_frame)

# Create data.frame for layer_spec_counts comparison
layer_spec_counts_frame <- data.frame(c(NA), c(NA), c(NA), c(NA), c(NA))
names(layer_spec_counts_frame) <- c(
    "Layer Type",
    "Layer Specific Field/Value",
    paste0("Object Count - ", current_version),
    paste0("Object Count - ", previous_version),
    "Delta"
)
# Delete all rows
layer_spec_counts_frame <- layer_spec_counts_frame[-1,1:length(layer_spec_counts_frame)]
head(layer_spec_counts_frame)

appendCountToFrame <- function (type, layer, stat) {
    #print(stat["current"])
    #print(stat["previous"])
    delta <- c(as.numeric(stat["current"]) - as.numeric(stat["previous"]))
    data.frame(
        type, # "Layer Type",
        layer, # "Layer",
        format(round(as.numeric(stat["current"]), 0), nsmall = 0), # paste0("Object Count - ", current_version),
        format(round(as.numeric(stat["previous"]), 0), nsmall = 0), # paste0("Object Count - ", previous_version),
        format(round(delta, 0), nsmall = 0), # "Delta"
        stringsAsFactors = FALSE
    )
}

appendLengthToFrame <- function (type, layer_class, stat) {
    current_length <- c(NA)
    previous_length <- c(NA)

    switch(
        length_units,
        "miles" = { # meters => miles
            if (!is.na(stat["current"]) && grepl("\\d+", stat["current"], perl = TRUE)) {
                current_length <- as.double(stat["current"]) * 0.000621371
                print(paste0(stat["current"], " => ", current_length))

            } else {
                print(layer_class)
                current_length <- switch(
                    layer_class,
                    "s1" = { c(NA) },
                    "s2" = { c(NA) },
                    "s3" = { c(NA) },
                    "s4" = { c(NA) },
                    "s5" = { c(NA) },
                    "s6" = { c(NA) },
                    "streets" = { c(NA) },
                    "expressways" = { c(NA) },
                    "localrtes" = { c(NA) },
                    "primaryhwys" = { c(NA) },
                    "secondaryhwys" = { c(NA) },
                    { as.double(0.0) }
                )
            }

            if (!is.na(stat["previous"]) && grepl("\\d+", stat["previous"], perl = TRUE)) {
                previous_length <- as.double(stat["previous"]) * 0.000621371
                print(paste0(as.double(stat["previous"]), " => ", previous_length))

            } else {
                print(layer_class)
                previous_length <- switch(
                    layer_class,
                    "s1" = { c(NA) },
                    "s2" = { c(NA) },
                    "s3" = { c(NA) },
                    "s4" = { c(NA) },
                    "s5" = { c(NA) },
                    "s6" = { c(NA) },
                    "streets" = { c(NA) },
                    "expressways" = { c(NA) },
                    "localrtes" = { c(NA) },
                    "primaryhwys" = { c(NA) },
                    "secondaryhwys" = { c(NA) },
                    { if (!is.null(streets_previous) && !is.na(streets_previous)) { as.double(0.0) } else { c(NA) } }
                )
            }

        },
        { # meters => kilometers
            if (!is.na(stat["current"]) && grepl("\\d+", stat["current"], perl = TRUE)) {
                current_length <- as.double(stat["current"]) * 0.001
                print(paste0(stat["current"], " => ", current_length))

            } else {
                print(layer_class)
                current_length <- switch(
                    layer_class,
                    "s1" = { c(NA) },
                    "s2" = { c(NA) },
                    "s3" = { c(NA) },
                    "s4" = { c(NA) },
                    "s5" = { c(NA) },
                    "s6" = { c(NA) },
                    "streets" = { c(NA) },
                    "expressways" = { c(NA) },
                    "localrtes" = { c(NA) },
                    "primaryhwys" = { c(NA) },
                    "secondaryhwys" = { c(NA) },
                    { as.double(0.0) }
                )
            }

            if (!is.na(stat["previous"]) && grepl("\\d+", stat["previous"], perl = TRUE)) {
                previous_length <- as.double(stat["previous"]) * 0.001
                print(paste0(as.double(stat["previous"]), " => ", previous_length))

            } else {
                print(layer_class)
                previous_length <- switch(
                    layer_class,
                    "s1" = { c(NA) },
                    "s2" = { c(NA) },
                    "s3" = { c(NA) },
                    "s4" = { c(NA) },
                    "s5" = { c(NA) },
                    "s6" = { c(NA) },
                    "streets" = { c(NA) },
                    "expressways" = { c(NA) },
                    "localrtes" = { c(NA) },
                    "primaryhwys" = { c(NA) },
                    "secondaryhwys" = { c(NA) },
                    { if (!is.null(streets_previous) && !is.na(streets_previous)){ as.double(0.0) } else { c(NA)} }
                )
            }
        }
    )

    delta <- c(as.double(current_length) - as.double(previous_length))

    data.frame(
        type, # "Streets Type",
        layer_class, # "Layer Name (Road Class)",
        format(round(current_length, 2), nsmall = 2), # paste0("Length (", length_units, ") - ", current_version),
        format(round(previous_length, 2), nsmall = 2), #paste0("Length (", length_units, ") - ", previous_version),
        format(round(delta, 2), nsmall = 2), # "Delta"
        stringsAsFactors = FALSE
    )
}

# Counts
# Avoid rbind when appending rows to 0-length data.frames
counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Navigation", "Nodes", nodes_total)
counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Navigation", "Restrictions", restrictions_total)
counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Navigation", "Streets", streets_total)
speed_profiles_frame[nrow(speed_profiles_frame)+1,] <- appendCountToFrame("Speed Profiles", "Speed Profile Sets", speed_profile_sets_total)

if ((!is.null(state_codes)) && (!is.na(state_codes)) && (country_code3 == "usa" || country_code3 == "can")) {
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Classic", "crossroads", crossroads_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Classic", "geocode1", geocode1_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Classic", "geocode2", geocode2_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Classic", "sa", sa_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "airports", airports_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "cities", cities_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "expressways", expressways_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "ferries", ferries_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "gazetteer1", gazetteer1_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "gazetteer2", gazetteer2_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "gazetteer3", gazetteer3_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "gazetteer4", gazetteer4_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "gazetteer5", gazetteer5_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "gazetteer6", gazetteer6_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "gazetteer7", gazetteer7_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "landmarks", landmarks_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "landuse", landuse_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "localhwys_med", localhwys_med_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "localrtes", localrtes_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "oneways", oneways_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "primaryhwys", primaryhwys_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "primaryhwys_med", primaryhwys_med_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "railroads", railroads_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "regionalhwys", regionalhwys_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "rivers", rivers_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "secondaryhwys", secondaryhwys_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "secondaryhwys_med", secondaryhwys_med_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "signposts", signposts_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "streets", displaystreets_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "urbanareas", urbanareas_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "waterbodies", waterbodies_total)

}

if (!is.null(country_code3[[1]]) && !is.na(country_code3) && (country_code3 == "usa")) {
    # US only

    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "counties", counties_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldco_0to5", shldco_0to5_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldco_5to15", shldco_5to15_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldco_15to50", shldco_15to50_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldinter_0to5", shldinter_0to5_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldinter_5to15", shldinter_5to15_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldinter_15to50", shldinter_15to50_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldstate_0to5", shldstate_0to5_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldstate_5to15", shldstate_5to15_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldstate_15to50", shldstate_15to50_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldus_0to5", shldus_0to5_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldus_5to15", shldus_5to15_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldus_15to50", shldus_15to50_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "towns", towns_total)
}

if (!is.null(country_code3[[1]]) && !is.na(country_code3) && (country_code3 == "can")) {
    # CAN only

    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "censusdivisions", censusdivisions_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "censussubdivisions", censussubdivisions_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldprhwy_0to5", shldprhwy_0to5_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldprhwy_5to15", shldprhwy_5to15_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldprhwy_15to50", shldprhwy_15to50_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldtchwy_0to5", shldtchwy_0to5_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldtchwy_5to15", shldtchwy_5to15_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "shldtchwy_15to50", shldtchwy_15to50_total)
}

if (!is.null(country_code4[[1]]) && !is.na(country_code4)) {
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Classic", "cr", cr_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Classic", "sa", sa_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Classic", "x1", x1_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Classic", "x2", x2_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "a0", a0_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "a1", a1_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "a2", a2_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "a3", a3_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "a4", a4_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "a5", a5_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "aa", aa_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "ap", ap_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "b", b_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "f", f_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "fi", fi_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "fr", fr_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "g1", g1_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "g2", g2_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "g3", g3_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "g4", g4_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "g5", g5_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "g6", g6_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "gf", gf_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "lc", lc_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "lu", lu_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "nf", nf_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "ow", ow_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "p", p_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "pc", pc_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "pci", pci_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "pcp", pcp_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "pu", pu_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "r", r_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "re", re_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "st", st_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "u", u_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "wm", wm_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "w", w_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "zl", zl_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "zp", zp_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "s1", s1_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "s2", s2_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "s3", s3_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "s4", s4_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "s5", s5_total)
    counts_frame[nrow(counts_frame)+1,] <- appendCountToFrame("Display", "s6", s6_total)
}

# Street Lengths
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (All Road Classes)", Length_total)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class A)", Length_A)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class C)", Length_C)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class D)", Length_D)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class E)", Length_E)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class F)", Length_F)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class G)", Length_G)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class H)", Length_H)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class I)", Length_I)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class L)", Length_L)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class M)", Length_M)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class N)", Length_N)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class P)", Length_P)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class Q)", Length_Q)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class R)", Length_R)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class S)", Length_S)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class T)", Length_T)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class U)", Length_U)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class W)", Length_W)
street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Navigation", "Streets (Road Class Z)", Length_Z)

if ((!is.null(state_codes)) && (!is.na(state_codes)) && (country_code3 == "usa" || country_code3 == "can")) {
    street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Display", "streets", Length_displaystreets)
    street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Display", "expressways", Length_expressways)
    street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Display", "localrtes", Length_localrtes)
    street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Display", "primaryhwys", Length_primaryhwys)
    street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Display", "secondaryhwys", Length_secondaryhwys)
}

if (!is.null(country_code4[[1]]) && !is.na(country_code4)) {
    street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Display", "s1", Length_s1)
    street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Display", "s2", Length_s2)
    street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Display", "s3", Length_s3)
    street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Display", "s4", Length_s4)
    street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Display", "s5", Length_s5)
    street_lengths_frame[nrow(street_lengths_frame)+1,] <- appendLengthToFrame("Display", "s6", Length_s6)
}

# Layer Specific Counts
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "All Streets", streets_total)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "Street Name 1 (STREET)", STREET)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "Street Name 2 (STREET2)", STREET2)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "Street Name 3 (STREET3)", STREET3)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "Street Name 4 (STREET4)", STREET4)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "FROMLEFT", FROMLEFT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "TOLEFT", TOLEFT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "FROMRIGHT", FROMRIGHT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "TORIGHT", TORIGHT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "L_STRUCT 1", L_STRUCT_1)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "L_STRUCT 2", L_STRUCT_2)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "L_STRUCT 3", L_STRUCT_3)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "L_STRUCT 4", L_STRUCT_4)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "L_STRUCT 5", L_STRUCT_5)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "L_STRUCT 6", L_STRUCT_6)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "R_STRUCT 1", R_STRUCT_1)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "R_STRUCT 2", R_STRUCT_2)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "R_STRUCT 3", R_STRUCT_3)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "R_STRUCT 4", R_STRUCT_4)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "R_STRUCT 5", R_STRUCT_6)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "R_STRUCT 6", R_STRUCT_6)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "A1_LEFT", A1_LEFT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "A1_RIGHT", A1_RIGHT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "LOCALITY_LEFT", LOCALITY_LEFT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "LOCALITY_CODE_LEFT", LOCALITY_CODE_LEFT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "LOCALITY_RIGHT", LOCALITY_RIGHT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "LOCALITY_CODE_RIGHT", LOCALITY_CODE_RIGHT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "PC_LEFT", PC_LEFT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "PNAM_LEFT", PNAM_LEFT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "PC_RIGHT", PC_RIGHT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "PNAM_RIGHT", PNAM_RIGHT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "ROUTE_NUM", ROUTE_NUM)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "Rural Streets (AREA_TYPE 0)", AREA_TYPE_0)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "Urban Streets (AREA_TYPE 1)", AREA_TYPE_1)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "ROAD_TYPE D", ROAD_TYPE_D)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "ROAD_TYPE S", ROAD_TYPE_S)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "Streets with Sign Post Speed Limits (Speed_Verified 1)", SPEED_VERIFIED)
SPEED_MODELLED <- (as.numeric(SPEED) - as.numeric(SPEED_VERIFIED))
names(SPEED_MODELLED) <- c("current", "previous")
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "Streets with Modelled Speed Limits (Speed_Verified 2)", SPEED_MODELLED)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "SPEED_AMPEAK", SPEED_AMPEAK)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "SPEED_PMPEAK", SPEED_PMPEAK)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "SPEED_INTERPEAK", SPEED_INTERPEAK)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "SPEED_NIGHT", SPEED_NIGHT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "SPEED_SEVENDAY", SPEED_SEVENDAY)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "ROUGHRD", ROUGHRD)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "SURFACE_TYPE 0", SURFACE_TYPE_0)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "SURFACE_TYPE 1", SURFACE_TYPE_1)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "SURFACE_TYPE 2", SURFACE_TYPE_2)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "SURFACE_TYPE 3", SURFACE_TYPE_3)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "MAX_HEIGHT Restrictions", MAX_HEIGHT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "MAX_WEIGHT Restrictions", MAX_WEIGHT)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "MAX_WIDTH Restrictions", MAX_WIDTH)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "ONEWAY 1", ONEWAY_1)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "ONEWAY 2", ONEWAY_2)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "ONEWAY 3", ONEWAY_3)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "ONEWAY 4", ONEWAY_4)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "ONEWAY 5", ONEWAY_5)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "ONEWAY 6", ONEWAY_6)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "Toll Roads (TOLL: true)", TOLL_true)
layer_spec_counts_frame[nrow(layer_spec_counts_frame)+1,] <- appendCountToFrame("Navigation", "Non-toll Roads (TOLL: false)", TOLL_false)

```

Write the frames out to disk:

```{r write_stats, echo=FALSE}
check_release_dir <- function (vers, ctry) {
    ifelse(!dir.exists(file.path(".", vers)), dir.create(file.path(".", vers)), FALSE)
    ifelse(!dir.exists(file.path(vers, ctry)), dir.create(file.path(vers, ctry)), FALSE)
    dir.exists(file.path(vers, ctry))
}

writeFrameToExcel <- function (workbook, sheet_name, frame) {
    print(paste0("Add ", sheet_name, " to workbook:"))
    print(workbook)

    openxlsx::addWorksheet(workbook, sheet_name)

    for(i in seq_along(frame)){
        openxlsx::writeData(workbook, sheet = sheet_name, names(frame)[i], startCol = i, startRow = 1)
        icol <- frame[[i]]
        for(j in seq_along(icol)){
            if (!is.na(icol[[j]])) {
                if (grepl("[A-Za-z]+", icol[[j]], perl = TRUE)) {
                    x <- icol[[j]]
                } else if (grepl("\\.\\d", icol[[j]], perl = TRUE)) {
                    x <- as.double(icol[[j]])
                } else if (grepl("\\d", icol[[j]], perl = TRUE)) {
                    x <- as.integer(icol[[j]])
                } else {
                    x <- icol[[j]]
                }
            } else {
                x <- icol[[j]]
            }
            # print(paste0(icol[[j]], " is of type ", typeof(x)))
            openxlsx::writeData(workbook, sheet = sheet_name, x, startCol = i, startRow = j + 1)
        }
    }
}

if (check_release_dir("CURRENT", country)) {
    if (all(state_flag) && check_release_dir("CURRENT", paste0(country, "/", state_codes[[1]]))) {
        #write.csv(counts_frame,
        #          file = paste0(working_dir, "/", "CURRENT/", paste0(country, "/", state_codes[[1]]), "/Counts.csv"),
        #          na = "",
        #          row.names = FALSE,
        #          col.names = FALSE,
        #          append = TRUE,
        #          sep = ",")
        #write.csv(street_lengths_frame,
        #          file = paste0(working_dir, "/", "CURRENT/", paste0(country, "/", state_codes[[1]]), "/Street_Lengths.csv"),
        #          na = "",
        #          row.names = FALSE,
        #          col.names = FALSE,
        #          append = TRUE,
        #          sep = ",")
        #write.csv(layer_spec_counts_frame,
        #          file = paste0(working_dir, "/", "CURRENT/", paste0(country, "/", state_codes[[1]]), "/Layer_Specific_Counts.csv"),
        #          na = "",
        #          row.names = FALSE,
        #          col.names = FALSE,
        #          append = TRUE,
        #          sep = ",")
        head(counts_frame)
        head(street_lengths_frame)
        head(layer_spec_counts_frame)
        if (require("openxlsx") && require("readtext")) {
            wb <- openxlsx::loadWorkbook(paste0(working_dir, "/src/templates/streetpro_product_statistics.xlsx"))
            names(wb)[[1]] <- paste0(country, "-", state_codes[[1]], " ", current_version, " Release Notes")
            changelog_txt <- paste0(working_dir, "/", current_version, "/", country, "/", "Change_Log.txt")
            if (file.exists(changelog_txt)) {
                changelog <- readtext::readtext(changelog_txt, encoding = "UTF-8")[[2]]
                print(changelog)
                writeData(wb, 1, list("notes" =  str_replace_all(changelog, fixed("*"), "\u2022")), startCol = 1, startRow = 5, colNames = FALSE)
            } else {
                writeData(wb, 1, list("notes" = paste0("Release notes for ", country, "-", state_codes[[1]])), startCol = 1, startRow = 5, colNames = FALSE)
            }
            writeFrameToExcel(wb, "Counts", counts_frame)
            writeFrameToExcel(wb, "Street Lengths", street_lengths_frame)
            writeFrameToExcel(wb, "Navigation Specific Counts", layer_spec_counts_frame)

            print(paste0("Writing out workbook: "))
            print(wb)
            openxlsx::saveWorkbook(
                wb,
                file = paste0(
                    working_dir, "/", "CURRENT/",
                    paste0(country, "/", state_codes[[1]]),
                    "/StreetPro_Product_Statistics-", paste0(country, "-", state_codes[[1]]),
                    ".xlsx"
                ),
                overwrite = TRUE
            )
            print("")
            print(paste0("Does workbook exist: ",
                    working_dir, "/", "CURRENT/",
                    paste0(country, "/", state_codes[[1]]),
                    "/StreetPro_Product_Statistics-", paste0(country, "-", state_codes[[1]]),
                    ".xlsx"
                ))
            print(file.exists(paste0(
                    working_dir, "/", "CURRENT/",
                    paste0(country, "/", state_codes[[1]]),
                    "/StreetPro_Product_Statistics-", paste0(country, "-", state_codes[[1]]),
                    ".xlsx"
                )))
            print("")

            sp_wb <- openxlsx::loadWorkbook(paste0(working_dir, "/src/templates/streetpro_product_statistics.xlsx"))
            names(sp_wb)[[1]] <- paste0(country, "-", state_codes[[1]], " ", current_version, " Release Notes")
            changelog_txt <- paste0(working_dir, "/", current_version, "/", country, "/", "Change_Log.txt")
            if (file.exists(changelog_txt)) {
                changelog <- readtext::readtext(changelog_txt, encoding = "UTF-8")[[2]]
                print(changelog)
                writeData(sp_wb, 1, list("notes" =  str_replace_all(changelog, fixed("*"), "\u2022")), startCol = 1, startRow = 5, colNames = FALSE)
            } else {
                writeData(sp_wb, 1, list("notes" = paste0("Release notes for ", country, "-", state_codes[[1]])), startCol = 1, startRow = 5, colNames = FALSE)
            }
            writeFrameToExcel(sp_wb, "Counts", speed_profiles_frame)

            print(paste0("Writing out speed profiles workbook: "))
            print(sp_wb)
            openxlsx::saveWorkbook(
                sp_wb,
                file = paste0(
                    working_dir, "/", "CURRENT/",
                    paste0(country, "/", state_codes[[1]]),
                    "/StreetPro_Speed_Profiles_Statistics-", paste0(country, "-", state_codes[[1]]),
                    ".xlsx"
                ),
                overwrite = TRUE
            )
            print("")
        }
    } else {
        #write.csv(counts_frame,
        #          file = paste0(working_dir, "/", "CURRENT/", country, "/Counts.csv"),
        #          na = "",
        #          row.names = FALSE,
        #          col.names = FALSE,
        #          append = TRUE,
        #          sep = ",")
        #write.csv(street_lengths_frame,
        #          file = paste0(working_dir, "/", "CURRENT/", country, "/Street_Lengths.csv"),
        #          na = "",
        #          row.names = FALSE,
        #          col.names = FALSE,
        #          append = TRUE,
        #          sep = ",")
        #write.csv(layer_spec_counts_frame,
        #          file = paste0(working_dir, "/", "CURRENT/", country, "/Layer_Specific_Counts.csv"),
        #          na = "",
        #          row.names = FALSE,
        #          col.names = FALSE,
        #          append = TRUE,
        #          sep = ",")
        head(counts_frame)
        head(street_lengths_frame)
        head(layer_spec_counts_frame)
        if (require("openxlsx") && require("readtext")) {
            wb <- openxlsx::loadWorkbook(paste0(working_dir, "/src/templates/streetpro_product_statistics.xlsx"))
            names(wb)[[1]] <- paste0(country, " ", current_version, " Release Notes")
            changelog_txt <- paste0(working_dir, "/", current_version, "/", country, "/", "Change_Log.txt")
            if (file.exists(changelog_txt)) {
                changelog <- readtext::readtext(changelog_txt, encoding = "UTF-8")[[2]]
                print(changelog)
                writeData(wb, 1, list("notes" =  str_replace_all(changelog, fixed("*"), "\u2022")), startCol = 1, startRow = 5, colNames = FALSE)
            } else {
                writeData(wb, 1, list("notes" = paste0("Release notes for ", country)), startCol = 1, startRow = 5, colNames = FALSE)
            }
            writeFrameToExcel(wb, "Counts", counts_frame)
            writeFrameToExcel(wb, "Street Lengths", street_lengths_frame)
            writeFrameToExcel(wb, "Navigation Specific Counts", layer_spec_counts_frame)

            print(paste0("Writing out workbook: "))
            print(wb)
            openxlsx::saveWorkbook(
                wb,
                file = paste0(
                    working_dir, "/", "CURRENT/",
                    country, "/StreetPro_Product_Statistics-", country,
                    ".xlsx"
                ),
                overwrite = TRUE
            )
            print("")
            print(paste0("Does workbook exist: ",
                         working_dir, "/", "CURRENT/",
                         country, "/StreetPro_Product_Statistics-", country,
                         ".xlsx"
            ))
            print(file.exists(paste0(
                working_dir, "/", "CURRENT/",
                country, "/StreetPro_Product_Statistics-", country,
                ".xlsx"
            )))
            print("")

            sp_wb <- openxlsx::loadWorkbook(paste0(working_dir, "/src/templates/streetpro_product_statistics.xlsx"))
            changelog_txt <- paste0(working_dir, "/", current_version, "/", country, "/", "Change_Log.txt")
            names(sp_wb)[[1]] <- paste0(country, " ", current_version, " Release Notes")
            if (file.exists(changelog_txt)) {
                changelog <- readtext::readtext(changelog_txt, encoding = "UTF-8")[[2]]
                print(changelog)
                writeData(sp_wb, 1, list("notes" =  str_replace_all(changelog, fixed("*"), "\u2022")), startCol = 1, startRow = 5, colNames = FALSE)
            } else {
                writeData(sp_wb, 1, list("notes" = paste0("Release notes for ", country)), startCol = 1, startRow = 5, colNames = FALSE)
            }
            writeFrameToExcel(sp_wb, "Counts", speed_profiles_frame)

            print(paste0("Writing out speed profiles workbook: "))
            print(sp_wb)
            openxlsx::saveWorkbook(
                sp_wb,
                file = paste0(
                    working_dir, "/", "CURRENT/",
                    country, "/StreetPro_Speed_Profiles_Statistics-", country,
                    ".xlsx"
                ),
                overwrite = TRUE
            )
            print("")
        }
    }
}

```

</div>

```{r title, echo=FALSE, results = "asis"}
if (is.null(state_codes[[1]]) || is.na(state_codes) || is.na(state_flag) || !state_flag) {
    cat(paste0("<h1>StreetPro ", country, " (", current_version, ")", " Release Statistics</h1>"))
} else {
    cat(paste0("<h1>StreetPro ", country, " - ", state_codes[[1]], " (", current_version, ")", " Release Statistics</h1>"))
}
cat(download_links)
```

<div class="bd-example bd-example-tabs tabs">
<div class="tab-content" id="myTabContent">
<div class="tab-pane fade active show" id="counts" role="tabpanel" aria-labelledby="counts-tab">

```{r, cache = FALSE, echo = FALSE}
#counts_frame <- datasets::iris
#str(counts_frame)
counts_frame %>%
    DT::datatable(extensions = 'Buttons',
                  options = list(dom = 'rtBip',
                                 buttons = c('csv', 'excel', 'pdf'),
                                 lengthMenu = list(c(25,25,100,-1),
                                                   c(50,25,100,"All"))))
```


</div>

<div class="tab-pane fade" id="fill-rates" role="tabpanel" aria-labelledby="fill-rates-tab">

```{r, cache = FALSE, echo = FALSE}
fill_rates_frame <- datasets::iris
#str(fill_rates_frame)
fill_rates_frame %>%
    DT::datatable(extensions = 'Buttons',
                  options = list(dom = 'rtBip',
                                 buttons = c('csv', 'excel', 'pdf'),
                                 lengthMenu = list(c(25,25,100,-1),
                                                   c(50,25,100,"All"))))
```


</div>

<div class="tab-pane fade" id="lengths" role="tabpanel" aria-labelledby="lengths-tab">

```{r, cache = FALSE, echo = FALSE}
#street_lengths_frame <- datasets::iris
#str(street_lengths_frame)
street_lengths_frame %>%
    DT::datatable(extensions = 'Buttons',
                  options = list(dom = 'rtBip',
                                 buttons = c('csv', 'excel', 'pdf'),
                                 lengthMenu = list(c(25,25,100,-1),
                                                   c(50,25,100,"All"))))
```


</div>

<div class="tab-pane fade" id="specific-counts" role="tabpanel" aria-labelledby="specific-counts-tab">

```{r, cache = FALSE, echo = FALSE}
#layer_spec_counts_frame <- datasets::iris
#str(layer_spec_counts_frame)
layer_spec_counts_frame %>%
    DT::datatable(extensions = 'Buttons',
                  options = list(dom = 'rtBip',
                                 buttons = c('csv', 'excel', 'pdf'),
                                 lengthMenu = list(c(25,25,100,-1),
                                                   c(50,25,100,"All"))))
```


</div>

<br />

</div>

<ul class="nav nav-tabs" id="myTab" role="tablist">

<li class="nav-item">
<a class="nav-link active" id="counts-tab" data-toggle="tab" href="#counts" role="tab" aria-controls="counts" aria-selected="true">Counts</a>
</li>
<li class="nav-item">
<a class="nav-link" id="fill-rates-tab" data-toggle="tab" href="#fill-rates" role="tab" aria-controls="fill-rates" aria-selected="false" disabled="true">Fill Rates (%)</a>
</li>
<li class="nav-item">
<a class="nav-link" id="lengths-tab" data-toggle="tab" href="#lengths" role="tab" aria-controls="lengths" aria-selected="false">Street Lengths</a>
</li>
<li class="nav-item">
<a class="nav-link" id="specific-counts-tab" data-toggle="tab" href="#specific-counts" role="tab" aria-controls="specific-counts" aria-selected="false">Navigation Specific Counts</a>
</li>
</ul>
</div>

<script src="/InProcess/ReleaseStatistics/js/popper.js"></script>
<script src="/InProcess/ReleaseStatistics/js/util.js"></script>
<script src="/InProcess/ReleaseStatistics/js/tab.js"></script>
